---
title: 前端工程化
order: 0
nav:
  title: 优秀文章
  path: /article
group:
  path: /webpack
  title: Webpack
  order: 5
---

# 前端工程化

`前端工程化`的主要目标就是解放生产力、提高生产效率。通过制定一系列的规范，借助工具和框架解决前端开发以及前后端协作过程中的痛点和难度问题。

前端越来越重，复杂度越来越高，配套的前端工程体系也在不断发展和完善，可简单分为开发、构建、发布 3 条主线：

- 前端框架：插件化（jQuery） -> 模块化（RequireJS） -> 组件化（React）
- 构建工具：任务化（grunt/gulp） -> 系统化（webpack）
- CI/CD：工具化（Jenkins） -> 自动化（Web Hook）

三大主线撑起了前端工程体系，系统地覆盖了前端开发的主流程，其中的工程方法也彼此互补、相互影响。

# webpack 的作用

webpack 的作用有以下几点：

- 模块打包。可以将不同模块的文件打包整合在一起，并且保证它们之间的引用正确，执行有序。利用打包我们就可以在开发的时候根据我们自己的业务自由划分文件模块，保证项目结构的清晰和可读性。
- 编译兼容。在前端的“上古时期”，手写一堆浏览器兼容代码一直是令前端工程师头皮发麻的事情，而在今天这个问题被大大的弱化了，通过`webpack` 的 `Loader` 机制，不仅仅可以帮助我们对代码做 `polyfill`，还可以编译转换诸如`.less`, `.vue`, `.jsx` 这类在浏览器无法识别的格式文件，让我们在开发的时候可以使用新特性和新语法做开发，提高开发效率。
- 能力扩展。通过 `webpack` 的 `Plugin` 机制，我们在实现模块化打包和编译兼容的基础上，可以进一步实现诸如按需加载，代码压缩等一系列功能，帮助我们进一步提高自动化程度，工程效率以及打包输出的质量。

# 打包运行原理

- 1、读取 `webpack` 的配置参数；
- 2、启动 `webpack`，创建 `Compiler` 对象并开始解析项目；
- 3、从入口文件（`entry`）开始解析，并且找到其导入的依赖模块，递归遍历分析，形成依赖关系树；
- 4、对不同文件类型的依赖模块文件使用对应的 Loader 进行编译，最终转为 Javascript 文件；
- 5、整个过程中 webpack 会通过发布订阅模式，向外抛出一些 hooks，而 webpack 的插件即可通过监听这些关键的事件节点，执行插件任务进而达到干预输出结果的目的。

其中文件的解析与构建是一个比较复杂的过程，在 `webpack` 源码中主要依赖于 `compiler` 和 `compilation` 两个核心对象实现。

`compiler` 对象是一个全局单例，他负责把控整个 `webpack` 打包的构建流程。`compilation` 对象是每一次构建的上下文对象，它包含了当次构建所需要的所有信息，每次热更新和重新构建，`compiler` 都会重新生成一个新的 `compilation` 对象，负责此次更新的构建过程。

而每个模块间的依赖关系，则依赖于 `AST` 语法树。每个模块文件在通过 `Loader` 解析完成之后，会通过 `acorn` 库生成模块代码的 `AST` 语法树，通过语法树就可以分析这个模块是否还有依赖的模块，进而继续循环执行下一个模块的编译解析。
